
# Класс GDrive для работы с Google Drive

Класс GDrive предназначен для взаимодействия с облачным хранилищем Google Drive с использованием бибилиотеки `pydrive2`.

**Атрибуты:**

* `_drive` (GoogleDrive): Объект класса GoogleDrive, представляющий собой подключение к Google Drive.

**Методы:**

* `__init__(self, service:bool=True)`: Инициализирует экземпляр класса.
    * Параметр `service` (bool, по умолчанию True) определяет способ авторизации:
        * `True` - использует сервис-аккаунт, указанный в файле `service_secrets.json`.
        * `False` - использует локальные учетные данные, сохраненные в файле `credentials.txt`.
* `load_file(self, filename: str="table.xlsx") -> int`: Загружает файл в Google Drive и возвращает его идентификатор.
* `update_loaded_file(self, file_id: str=None, filename: str="table.xlsx") -> bool`: Обновляет загруженный файл в Google Drive.
    * Возвращает `True` в случае успешного обновления, иначе `False`.
* `test_check_trash(self)`: (Тестовый метод) Печатает список идентификаторов файлов, находящихся в корзине. (Не рекомендуется использовать в рабочем коде)
* `_check_file_in_trash(self, file_id: str=None) -> bool`: Проверяет, находится ли файл с указанным идентификатором в корзине.
* `_untrash(self, file_id: str=None) -> bool`: Восстанавливает файл из корзины.
    * Возвращает `True` в случае успешного восстановления, иначе `False`.
* `repair(self, file_id: str=None, filename: str="table.xlsx") -> None or str`: Восстанавливает или перезагружает файл в Google Drive.
    * Принимает идентификатор файла (`file_id`) и (необязательно) имя файла (`filename`).
    * Если файл находится в корзине, он восстанавливается.
    * Если файл не найден или не находится в корзине, он загружается заново.
    * Возвращает `None` в случае успешного восстановления или загрузки, иначе возвращает сообщение об ошибке.

**Класс GDriveTest (Устаревший):**

Класс `GDriveTest` является устаревшим и идентичен классу `GDrive`. Его использование не рекомендуется.


**Примечание:**

* Методы `test_check_trash`, `_check_file_in_trash`, и `_untrash` помечены как тестовые и не рекомендуется использовать их в рабочем коде.
* Для работы с сервисным аккаунтом необходимо создать файл `service_secrets.json` и указать его путь в настройках.
